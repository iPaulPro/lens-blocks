{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "login",
  "type": "registry:block",
  "title": "Lens Login",
  "description": "A full-featured login flow for Lens Social Protocol that hooks into the Lens React SDK, uses ConnectKit for wallet connections, supports account switching and more.",
  "dependencies": [
    "@lens-protocol/react@0.0.0-canary-20250820102520",
    "connectkit@1.9.1",
    "react-virtuoso@4.13.0",
    "lucide-react",
    "viem@2.33.0",
    "wagmi@2.15.3"
  ],
  "registryDependencies": [
    "avatar",
    "button",
    "dialog",
    "skeleton",
    "@lens-blocks/utils",
    "@lens-blocks/paginated-list",
    "@lens-blocks/account-chooser",
    "@lens-blocks/login-button",
    "@lens-blocks/account-list-item",
    "@lens-blocks/use-login-with-viem"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/lens-login.tsx",
      "content": "\"use client\";\n\nimport { LensLoginButton } from \"@/registry/new-york/components/account/lens-login-button\";\nimport {\n  Account,\n  AuthenticatedUser,\n  LoginError,\n  SessionClient,\n  useAuthenticatedUser,\n  useLogout,\n} from \"@lens-protocol/react\";\nimport { Link2Off } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/registry/new-york/ui/dialog\";\nimport { LensAccountChooser } from \"@/registry/new-york/components/account/lens-account-chooser\";\nimport { Button } from \"@/registry/new-york/ui/button\";\nimport { useAccount, useDisconnect } from \"wagmi\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useModal } from \"connectkit\";\nimport { useLensLoginWithViem } from \"@/registry/new-york/hooks/use-lens-login-with-viem\";\nimport { WalletClient } from \"viem\";\nimport { Result } from \"@/registry/new-york/lib/result\";\n\ntype LensLoginProps = {\n  /**\n   * The Lens Client used for making public and authenticated calls\n   */\n  session: Result<SessionClient>;\n\n  /**\n   * The wallet client from viem used to sign messages for authentication.\n   * If not provided, follow/unfollow button will not be rendered.\n   */\n  wallet?: { data: WalletClient | undefined | null; isLoading?: boolean; error?: unknown };\n\n  /**\n   * The address of the app registered with Lens.\n   */\n  appAddress?: string;\n\n  /**\n   * Callback function that is called when the user successfully logs in.\n   */\n  onSuccess?: (authenticatedUser: AuthenticatedUser) => void;\n\n  /**\n   * Callback function that is called when there is an error during login.\n   */\n  onError?: (error: LoginError) => void;\n};\n\nexport const LensLogin = (props: LensLoginProps) => {\n  const { session, wallet, appAddress, onSuccess, onError } = props;\n  const walletClient = wallet?.data;\n  const sessionClient = session.data;\n\n  const [accountChooserOpen, setAccountChooserOpen] = useState(false);\n  const [selectedAccount, setSelectedAccount] = useState<Account | null>(null);\n\n  const { loading: authenticatedUserLoading } = useAuthenticatedUser();\n  const { execute: login, loading: loginLoading, error: loginError } = useLensLoginWithViem({ sessionClient });\n  const { execute: logout, loading: logoutLoading } = useLogout();\n  const { address: walletAddress, isConnected, isConnecting, isReconnecting } = useAccount();\n  const { disconnect } = useDisconnect();\n  const { setOpen: setConnectModalOpen } = useModal({\n    onConnect: () => {\n      setAccountChooserOpen(true);\n    },\n  });\n\n  useEffect(() => {\n    if (loginError && onError) {\n      onError(loginError);\n    }\n  }, [loginError, onError]);\n\n  const onAccountSelected = useCallback(\n    async (selectedAccount: Account) => {\n      if (authenticatedUserLoading || loginLoading || !walletClient) {\n        return;\n      }\n\n      setSelectedAccount(selectedAccount);\n\n      const user = await login(walletClient, selectedAccount, appAddress);\n      if (user) {\n        setAccountChooserOpen(false);\n        onSuccess?.(user);\n      }\n      setSelectedAccount(null);\n    },\n    [onSuccess, walletClient, authenticatedUserLoading, loginLoading],\n  );\n\n  const onLoginButtonClick = () => {\n    if (!isConnected) {\n      setConnectModalOpen(true);\n    } else {\n      setAccountChooserOpen(true);\n    }\n  };\n\n  const onDisconnectButtonClick = async () => {\n    disconnect();\n    if (sessionClient?.isSessionClient()) {\n      await logout();\n    }\n  };\n\n  return (\n    <>\n      <LensLoginButton onClick={onLoginButtonClick} disabled={isConnecting || isReconnecting} />\n      {walletAddress && (\n        <Dialog open={accountChooserOpen} onOpenChange={setAccountChooserOpen}>\n          <DialogContent className=\"sm:max-w-sm\">\n            <DialogHeader className=\"border-b\">\n              <DialogTitle>Select an account</DialogTitle>\n              <DialogDescription>Choose a Lens account to log in with.</DialogDescription>\n            </DialogHeader>\n            <div className=\"flex flex-col gap-4 px-4 pb-4\">\n              <div className=\"h-48\">\n                <LensAccountChooser\n                  walletAddress={walletAddress}\n                  selectedAccount={selectedAccount}\n                  onAccountSelected={onAccountSelected}\n                />\n              </div>\n              <Button\n                variant=\"secondary\"\n                size=\"sm\"\n                className=\"w-fit text-xs hover:bg-destructive/90 hover:text-white z-10\"\n                disabled={logoutLoading}\n                onClick={() => onDisconnectButtonClick()}\n              >\n                {logoutLoading ? (\n                  <>\n                    <Link2Off className=\"size-3\" />\n                    Disconnecting...\n                  </>\n                ) : (\n                  <>\n                    <Link2Off className=\"size-3\" />\n                    Disconnect Wallet\n                  </>\n                )}\n              </Button>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </>\n  );\n};\n",
      "type": "registry:block"
    },
    {
      "path": "registry/new-york/components/account/lens-account-list-item-skeleton.tsx",
      "content": "import { Skeleton } from \"@/registry/new-york/ui/skeleton\";\n\nexport const LensAccountListItemSkeleton = () => {\n  return (\n    <div className=\"w-full flex items-center space-x-2 p-2\">\n      <Skeleton className=\"h-10 w-10 rounded-full flex-none\" />\n      <div className=\"flex-grow space-y-1.5\">\n        <Skeleton className=\"h-4 w-5/12\" />\n        <Skeleton className=\"h-3 w-3/12\" />\n      </div>\n      <Skeleton className=\"w-4 h-4\" />\n    </div>\n  );\n};\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/lib/result.ts",
      "content": "export type Result<T, E = never> = {\n  data: T | null | undefined;\n  error?: E | null | undefined;\n  loading?: boolean;\n};\n",
      "type": "registry:lib"
    }
  ]
}
